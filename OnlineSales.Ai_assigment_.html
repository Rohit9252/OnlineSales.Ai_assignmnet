<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=OPeqXG-QxW3ZD8BtmPikfA');.lst-kix_ufkvq2do7zm9-5>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-5}ul.lst-kix_43p845uk44qo-8{list-style-type:none}ul.lst-kix_43p845uk44qo-7{list-style-type:none}ul.lst-kix_43p845uk44qo-6{list-style-type:none}ul.lst-kix_43p845uk44qo-5{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-0{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-1{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-2{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-3{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-4{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-5{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-6{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-7{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-8{list-style-type:none}.lst-kix_ufkvq2do7zm9-3>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-3}ol.lst-kix_fzlixbgebtkx-5.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-5 0}.lst-kix_fzlixbgebtkx-7>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-7}.lst-kix_ufkvq2do7zm9-6>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-6}ul.lst-kix_43p845uk44qo-4{list-style-type:none}ul.lst-kix_43p845uk44qo-3{list-style-type:none}ul.lst-kix_43p845uk44qo-2{list-style-type:none}ul.lst-kix_43p845uk44qo-1{list-style-type:none}ol.lst-kix_fzlixbgebtkx-2.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-2 0}ul.lst-kix_43p845uk44qo-0{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-7.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-7 0}.lst-kix_ufkvq2do7zm9-2>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-2}.lst-kix_ufkvq2do7zm9-8>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-8,lower-roman) ". "}.lst-kix_ufkvq2do7zm9-7>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-7,lower-latin) ". "}.lst-kix_fzlixbgebtkx-0>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-0,decimal) ". "}.lst-kix_ufkvq2do7zm9-8>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-8}ol.lst-kix_fzlixbgebtkx-1.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-1 0}ol.lst-kix_ufkvq2do7zm9-1.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-1 0}.lst-kix_ufkvq2do7zm9-6>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-6,decimal) ". "}.lst-kix_y8mqfirhodvz-0>li:before{content:"\0025cf  "}.lst-kix_y8mqfirhodvz-1>li:before{content:"\0025cb  "}.lst-kix_ufkvq2do7zm9-5>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-5,lower-roman) ". "}.lst-kix_y8mqfirhodvz-4>li:before{content:"\0025cb  "}.lst-kix_y8mqfirhodvz-5>li:before{content:"\0025a0  "}.lst-kix_fzlixbgebtkx-3>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-3,decimal) ". "}.lst-kix_fzlixbgebtkx-5>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-5,lower-roman) ". "}.lst-kix_y8mqfirhodvz-2>li:before{content:"\0025a0  "}.lst-kix_y8mqfirhodvz-6>li:before{content:"\0025cf  "}ol.lst-kix_ufkvq2do7zm9-8.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-8 0}.lst-kix_fzlixbgebtkx-4>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-4,lower-latin) ". "}ol.lst-kix_fzlixbgebtkx-8.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-8 0}.lst-kix_fzlixbgebtkx-1>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-1,lower-latin) ". "}.lst-kix_y8mqfirhodvz-3>li:before{content:"\0025cf  "}.lst-kix_fzlixbgebtkx-2>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-2,lower-roman) ". "}.lst-kix_y8mqfirhodvz-8>li:before{content:"\0025a0  "}.lst-kix_fzlixbgebtkx-7>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-7,lower-latin) ". "}.lst-kix_y8mqfirhodvz-7>li:before{content:"\0025cb  "}ol.lst-kix_fzlixbgebtkx-0.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-0 0}.lst-kix_fzlixbgebtkx-6>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-6,decimal) ". "}.lst-kix_fzlixbgebtkx-8>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-8}.lst-kix_ufkvq2do7zm9-2>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-2,lower-roman) ". "}ol.lst-kix_fzlixbgebtkx-7{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-2.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-2 0}.lst-kix_fzlixbgebtkx-2>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-2}ol.lst-kix_fzlixbgebtkx-8{list-style-type:none}.lst-kix_ufkvq2do7zm9-0>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-0,decimal) ". "}.lst-kix_ufkvq2do7zm9-4>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-4,lower-latin) ". "}.lst-kix_ufkvq2do7zm9-3>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-3,decimal) ". "}.lst-kix_fzlixbgebtkx-5>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-5}.lst-kix_fzlixbgebtkx-8>li:before{content:"" counter(lst-ctn-kix_fzlixbgebtkx-8,lower-roman) ". "}ol.lst-kix_fzlixbgebtkx-1{list-style-type:none}ol.lst-kix_fzlixbgebtkx-7.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-7 0}ol.lst-kix_fzlixbgebtkx-2{list-style-type:none}ol.lst-kix_fzlixbgebtkx-0{list-style-type:none}ol.lst-kix_fzlixbgebtkx-5{list-style-type:none}ol.lst-kix_fzlixbgebtkx-6{list-style-type:none}ol.lst-kix_fzlixbgebtkx-3{list-style-type:none}.lst-kix_ufkvq2do7zm9-1>li:before{content:"" counter(lst-ctn-kix_ufkvq2do7zm9-1,lower-latin) ". "}ol.lst-kix_fzlixbgebtkx-4{list-style-type:none}ol.lst-kix_fzlixbgebtkx-6.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-6 0}ol.lst-kix_ufkvq2do7zm9-6.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-6 0}ol.lst-kix_fzlixbgebtkx-3.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-3 0}ol.lst-kix_ufkvq2do7zm9-3.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-3 0}.lst-kix_fzlixbgebtkx-3>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-3}ul.lst-kix_y8mqfirhodvz-5{list-style-type:none}ul.lst-kix_y8mqfirhodvz-4{list-style-type:none}ul.lst-kix_y8mqfirhodvz-7{list-style-type:none}ul.lst-kix_y8mqfirhodvz-6{list-style-type:none}ol.lst-kix_ufkvq2do7zm9-0.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-0 0}ul.lst-kix_y8mqfirhodvz-8{list-style-type:none}.lst-kix_fzlixbgebtkx-4>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-4}ul.lst-kix_y8mqfirhodvz-1{list-style-type:none}ul.lst-kix_y8mqfirhodvz-0{list-style-type:none}ul.lst-kix_y8mqfirhodvz-3{list-style-type:none}ul.lst-kix_y8mqfirhodvz-2{list-style-type:none}.lst-kix_43p845uk44qo-4>li:before{content:"\0025cb  "}.lst-kix_ufkvq2do7zm9-0>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-0}.lst-kix_43p845uk44qo-5>li:before{content:"\0025a0  "}.lst-kix_43p845uk44qo-6>li:before{content:"\0025cf  "}.lst-kix_fzlixbgebtkx-1>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-1}.lst-kix_43p845uk44qo-7>li:before{content:"\0025cb  "}.lst-kix_43p845uk44qo-8>li:before{content:"\0025a0  "}.lst-kix_fzlixbgebtkx-0>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-0}ol.lst-kix_fzlixbgebtkx-4.start{counter-reset:lst-ctn-kix_fzlixbgebtkx-4 0}ol.lst-kix_ufkvq2do7zm9-4.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-4 0}.lst-kix_43p845uk44qo-3>li:before{content:"\0025cf  "}.lst-kix_43p845uk44qo-1>li:before{content:"\0025cb  "}.lst-kix_43p845uk44qo-2>li:before{content:"\0025a0  "}.lst-kix_43p845uk44qo-0>li:before{content:"\0025cf  "}.lst-kix_fzlixbgebtkx-6>li{counter-increment:lst-ctn-kix_fzlixbgebtkx-6}.lst-kix_ufkvq2do7zm9-1>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-1}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_ufkvq2do7zm9-5.start{counter-reset:lst-ctn-kix_ufkvq2do7zm9-5 0}.lst-kix_ufkvq2do7zm9-7>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-7}.lst-kix_ufkvq2do7zm9-4>li{counter-increment:lst-ctn-kix_ufkvq2do7zm9-4}ol{margin:0;padding:0}table td,table th{padding:0}.c0{background-color:#263238;padding-top:0pt;padding-bottom:0pt;line-height:1.3571428571428572;orphans:2;widows:2;text-align:left;height:11pt}.c19{background-color:#ffff00;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c2{color:#89ddff;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Courier New";font-style:normal}.c3{background-color:#263238;padding-top:0pt;padding-bottom:0pt;line-height:1.3571428571428572;orphans:2;widows:2;text-align:left}.c11{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Roboto";font-style:normal}.c15{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c6{color:#546e7a;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Courier New";font-style:italic}.c34{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c16{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c8{background-color:#ffff00;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;font-weight:700;text-decoration:underline}.c5{font-size:10.5pt;font-family:"Courier New";font-style:italic;color:#89ddff;font-weight:400}.c13{font-size:10.5pt;font-family:"Courier New";color:#89ddff;font-weight:400}.c24{color:#f78c6c;font-weight:400;font-size:10.5pt;font-family:"Courier New"}.c4{font-size:10.5pt;font-family:"Courier New";color:#c792ea;font-weight:400}.c26{font-size:10.5pt;font-family:"Courier New";color:#ff5370;font-weight:400}.c7{font-size:10.5pt;font-family:"Courier New";color:#c3e88d;font-weight:400}.c29{font-size:10.5pt;font-family:"Courier New";color:#b2ccd6;font-weight:400}.c14{font-size:10.5pt;font-family:"Courier New";color:#82aaff;font-weight:400}.c1{font-size:10.5pt;font-family:"Courier New";color:#eeffff;font-weight:400}.c12{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c22{color:#000000;font-size:16pt;font-family:"Arial"}.c20{text-decoration:none;vertical-align:baseline;font-style:normal}.c32{font-weight:400;font-size:11pt;font-family:"Arial"}.c21{font-size:12pt;font-family:"Roboto";font-weight:400}.c27{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;text-decoration:underline}.c33{text-decoration:none;vertical-align:baseline}.c10{padding:0;margin:0}.c25{margin-left:36pt;padding-left:0pt}.c31{background-color:#ffff00;font-size:14pt}.c23{margin-left:72pt;padding-left:0pt}.c30{margin-left:36pt}.c35{font-size:16pt}.c18{height:11pt}.c36{background-color:#ffffff}.c17{font-weight:700}.c28{background-color:#f3f3f3}.c9{color:#4a86e8}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c12 doc-content"><p class="c16"><span class="c22 c20 c17">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnlineSales.Ai Assignment</span></p><p class="c16 c18"><span class="c22 c20 c17"></span></p><p class="c16 c18"><span class="c20 c17 c22"></span></p><p class="c16"><span class="c35 c17">Task 1 SQL Query:- </span><span class="c15">Fetch the top 3 departments along with their name and average monthly salary. Below is the format of the report.</span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16"><span class="c17 c35">Query:-</span><span class="c17 c31">&nbsp; </span><span class="c19">SELECT &nbsp;d.NAME AS DEPT_NAME, AVG(s.AMT) AS AVG_MONTHLY_SALARY</span></p><p class="c16"><span class="c19">FROM departments d</span></p><p class="c16"><span class="c19">JOIN employees e ON d.ID = e.DEPT_ID</span></p><p class="c16"><span class="c19">JOIN salaries s ON e.ID = s.EMP_ID</span></p><p class="c16"><span class="c19">GROUP BY d.ID, d.NAME</span></p><p class="c16"><span class="c19">ORDER BY AVG_MONTHLY_SALARY DESC</span></p><p class="c16"><span class="c19">LIMIT 3;</span></p><p class="c16 c18"><span class="c22 c20 c17"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18"><span class="c15"></span></p><h2 class="c34" id="h.ij1mixoj99cg"><span class="c17">Task-2 Scripting:- </span><span class="c15">With the same attachment, use each worksheet as a CSV file and write a script (Bash or Python) that generates the same report. Data is to be read from the CSV files not from a database</span></h2><p class="c16 c18"><span class="c15"></span></p><p class="c16"><span class="c17">Information</span><span>:- I used </span><span class="c8">Python </span><span class="c15">for this task. The code is written below </span></p><p class="c16 c18"><span class="c15"></span></p><p class="c3"><span class="c9"># create Index.py and run the test after reading CSV File </span></p><p class="c0"><span class="c5 c33"></span></p><p class="c3"><span class="c5">import</span><span class="c1 c20">&nbsp;csv</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Function to calculate average salary</span></p><p class="c3"><span class="c4">def</span><span class="c1">&nbsp;</span><span class="c14">calculate_average_salary</span><span class="c13">(</span><span class="c26">salaries</span><span class="c2">):</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; total_salary </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c14">sum</span><span class="c13">(</span><span class="c1">salaries</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; average_salary </span><span class="c4">=</span><span class="c1">&nbsp;total_salary </span><span class="c4">/</span><span class="c1">&nbsp;</span><span class="c14">len</span><span class="c13">(</span><span class="c1">salaries</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">return</span><span class="c1">&nbsp;</span><span class="c14">round</span><span class="c13">(</span><span class="c1">average_salary</span><span class="c13">,</span><span class="c1">&nbsp;</span><span class="c24">2</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Read departments from departments.csv</span></p><p class="c3"><span class="c1">departments </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c2">{}</span></p><p class="c3"><span class="c5">with</span><span class="c1">&nbsp;</span><span class="c14">open</span><span class="c13">(&#39;</span><span class="c7">departments.csv</span><span class="c13">&#39;,</span><span class="c1">&nbsp;</span><span class="c13">&#39;</span><span class="c7">r</span><span class="c13">&#39;)</span><span class="c1">&nbsp;</span><span class="c5">as</span><span class="c1">&nbsp;file</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; reader </span><span class="c4">=</span><span class="c1">&nbsp;csv</span><span class="c13">.</span><span class="c1">reader</span><span class="c13">(</span><span class="c1">file</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">next</span><span class="c13">(</span><span class="c1">reader</span><span class="c13">)</span><span class="c1">&nbsp; </span><span class="c6"># Skip header row</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">for</span><span class="c1">&nbsp;row </span><span class="c5">in</span><span class="c1">&nbsp;reader</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; department_id </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c1">row</span><span class="c13">[</span><span class="c24">0</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; department_name </span><span class="c4">=</span><span class="c1">&nbsp;row</span><span class="c13">[</span><span class="c24">1</span><span class="c2">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; departments</span><span class="c13">[</span><span class="c1">department_id</span><span class="c13">]</span><span class="c1">&nbsp;</span><span class="c4">=</span><span class="c1 c20">&nbsp;department_name</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Read employees from employees.csv</span></p><p class="c3"><span class="c1">employees </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c2">{}</span></p><p class="c3"><span class="c5">with</span><span class="c1">&nbsp;</span><span class="c14">open</span><span class="c13">(&#39;</span><span class="c7">employees.csv</span><span class="c13">&#39;,</span><span class="c1">&nbsp;</span><span class="c13">&#39;</span><span class="c7">r</span><span class="c13">&#39;)</span><span class="c1">&nbsp;</span><span class="c5">as</span><span class="c1">&nbsp;file</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; reader </span><span class="c4">=</span><span class="c1">&nbsp;csv</span><span class="c13">.</span><span class="c1">reader</span><span class="c13">(</span><span class="c1">file</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">next</span><span class="c13">(</span><span class="c1">reader</span><span class="c13">)</span><span class="c1">&nbsp; </span><span class="c6"># Skip header row</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">for</span><span class="c1">&nbsp;row </span><span class="c5">in</span><span class="c1">&nbsp;reader</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; employee_id </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c1">row</span><span class="c13">[</span><span class="c24">0</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; employee_name </span><span class="c4">=</span><span class="c1">&nbsp;row</span><span class="c13">[</span><span class="c24">1</span><span class="c2">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; department_id </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c1">row</span><span class="c13">[</span><span class="c24">2</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; employees</span><span class="c13">[</span><span class="c1">employee_id</span><span class="c13">]</span><span class="c1">&nbsp;</span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c13">(</span><span class="c1">employee_name</span><span class="c13">,</span><span class="c1">&nbsp;department_id</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Read salaries from salaries.csv</span></p><p class="c3"><span class="c1">salaries </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c2">{}</span></p><p class="c3"><span class="c5">with</span><span class="c1">&nbsp;</span><span class="c14">open</span><span class="c13">(&#39;</span><span class="c7">salaries.csv</span><span class="c13">&#39;,</span><span class="c1">&nbsp;</span><span class="c13">&#39;</span><span class="c7">r</span><span class="c13">&#39;)</span><span class="c1">&nbsp;</span><span class="c5">as</span><span class="c1">&nbsp;file</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; reader </span><span class="c4">=</span><span class="c1">&nbsp;csv</span><span class="c13">.</span><span class="c1">reader</span><span class="c13">(</span><span class="c1">file</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">next</span><span class="c13">(</span><span class="c1">reader</span><span class="c13">)</span><span class="c1">&nbsp; </span><span class="c6"># Skip header row</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">for</span><span class="c1">&nbsp;row </span><span class="c5">in</span><span class="c1">&nbsp;reader</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; employee_id </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c1">row</span><span class="c13">[</span><span class="c24">0</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; month </span><span class="c4">=</span><span class="c1">&nbsp;row</span><span class="c13">[</span><span class="c24">1</span><span class="c2">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; salary </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c1">row</span><span class="c13">[</span><span class="c24">2</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5">if</span><span class="c1">&nbsp;employee_id </span><span class="c4">in</span><span class="c1">&nbsp;salaries</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; salaries</span><span class="c13">[</span><span class="c1">employee_id</span><span class="c13">].</span><span class="c1">append</span><span class="c13">(</span><span class="c1">salary</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5">else</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; salaries</span><span class="c13">[</span><span class="c1">employee_id</span><span class="c13">]</span><span class="c1">&nbsp;</span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c13">[</span><span class="c1">salary</span><span class="c2">]</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Calculate average monthly salary for each department</span></p><p class="c3"><span class="c1">department_salaries </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c2">{}</span></p><p class="c3"><span class="c5">for</span><span class="c1">&nbsp;employee_id</span><span class="c13">,</span><span class="c1">&nbsp;</span><span class="c13">(</span><span class="c1">employee_name</span><span class="c13">,</span><span class="c1">&nbsp;department_id</span><span class="c13">)</span><span class="c1">&nbsp;</span><span class="c5">in</span><span class="c1">&nbsp;employees</span><span class="c13">.</span><span class="c1">items</span><span class="c2">():</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">if</span><span class="c1">&nbsp;department_id </span><span class="c4">in</span><span class="c1">&nbsp;departments</span><span class="c13">:</span><span class="c1">&nbsp; </span><span class="c6"># Check if department ID is valid</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5">if</span><span class="c1">&nbsp;department_id </span><span class="c4">in</span><span class="c1">&nbsp;department_salaries</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; department_salaries</span><span class="c13">[</span><span class="c1">department_id</span><span class="c13">].</span><span class="c1">extend</span><span class="c13">(</span><span class="c1">salaries</span><span class="c13">[</span><span class="c1">employee_id</span><span class="c2">])</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5">else</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; department_salaries</span><span class="c13">[</span><span class="c1">department_id</span><span class="c13">]</span><span class="c1">&nbsp;</span><span class="c4">=</span><span class="c1">&nbsp;salaries</span><span class="c13">[</span><span class="c1">employee_id</span><span class="c2">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">else</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c14">print</span><span class="c13">(</span><span class="c4">f</span><span class="c7">&quot;Invalid department ID for employee </span><span class="c24">{</span><span class="c1">employee_id</span><span class="c24">}</span><span class="c7">&quot;</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Generate the report</span></p><p class="c3"><span class="c14">print</span><span class="c13">(&quot;</span><span class="c7">DEPT_NAME </span><span class="c13">&quot;,</span><span class="c1">&nbsp;</span><span class="c13">&quot;</span><span class="c7">&nbsp;AVG_MONTHLY_SALARY (USD)</span><span class="c2">&quot;)</span></p><p class="c3"><span class="c6"># print(&quot;AVG_MONTHLY_SALARY (USD)&quot;)</span></p><p class="c3"><span class="c14">print</span><span class="c2">()</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Sort departments by average salary in descending order</span></p><p class="c3"><span class="c1">sorted_departments </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c14">sorted</span><span class="c13">(</span><span class="c1">department_salaries</span><span class="c13">.</span><span class="c1">items</span><span class="c13">(),</span><span class="c1">&nbsp;</span><span class="c26">key</span><span class="c4">=lambda</span><span class="c1">&nbsp;</span><span class="c26">x</span><span class="c13">:</span><span class="c1">&nbsp;calculate_average_salary</span><span class="c13">(</span><span class="c1">x</span><span class="c13">[</span><span class="c24">1</span><span class="c13">]),</span><span class="c1">&nbsp;</span><span class="c26">reverse</span><span class="c4">=</span><span class="c24">True</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c6"># Display top 3 departments</span></p><p class="c3"><span class="c5">for</span><span class="c1">&nbsp;i </span><span class="c5">in</span><span class="c1">&nbsp;</span><span class="c14">range</span><span class="c13">(</span><span class="c24">3</span><span class="c2">):</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; department_id</span><span class="c13">,</span><span class="c1">&nbsp;salaries </span><span class="c4">=</span><span class="c1">&nbsp;sorted_departments</span><span class="c13">[</span><span class="c1">i</span><span class="c2">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; department_name </span><span class="c4">=</span><span class="c1">&nbsp;departments</span><span class="c13">.</span><span class="c1">get</span><span class="c13">(</span><span class="c1">department_id</span><span class="c13">,</span><span class="c1">&nbsp;</span><span class="c13">&quot;</span><span class="c7">Unknown</span><span class="c2">&quot;)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; average_salary </span><span class="c4">=</span><span class="c1">&nbsp;calculate_average_salary</span><span class="c13">(</span><span class="c1">salaries</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">print</span><span class="c13">(</span><span class="c1">department_name</span><span class="c13">,&quot;</span><span class="c7">&nbsp;</span><span class="c13">&quot;,</span><span class="c1">&nbsp;average_salary</span><span class="c2">)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c6"># print(average_salary)</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">print</span><span class="c2">()</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18"><span class="c15"></span></p><h2 class="c34" id="h.vzm1mosechim"><span class="c17">Task-3 Debugging:- </span><span class="c15">Given below is a Bash / Python script that performs the following computation on an integer input (n):</span></h2><ol class="c10 lst-kix_ufkvq2do7zm9-0 start" start="1"><li class="c16 c25 li-bullet-0"><span class="c15">If n is less than 10: Calculate its Square</span></li></ol><ol class="c10 lst-kix_ufkvq2do7zm9-1 start" start="1"><li class="c16 c23 li-bullet-0"><span class="c15">Example: 4 =&gt; 16</span></li></ol><ol class="c10 lst-kix_ufkvq2do7zm9-0" start="2"><li class="c16 c25 li-bullet-0"><span class="c15">If n is between 10 and 20: Calculate the factorial of (n-10)</span></li></ol><ol class="c10 lst-kix_ufkvq2do7zm9-1 start" start="1"><li class="c16 c23 li-bullet-0"><span class="c15">Example: 15 =&gt; 120</span></li></ol><ol class="c10 lst-kix_ufkvq2do7zm9-0" start="3"><li class="c16 c25 li-bullet-0"><span class="c15">If n is greater than 20: Calculate the sum of all integers between 1 and (n-20)</span></li></ol><ol class="c10 lst-kix_ufkvq2do7zm9-1 start" start="1"><li class="c16 c23 li-bullet-0"><span class="c15">Example: 25 =&gt; 15</span></li></ol><p class="c16 c18"><span class="c15"></span></p><p class="c16"><span>The task is to identify the bugs in the script, fix them and share the new script. Only one of the two scripts required Bash or Python. </span><span class="c17 c27">Hint</span><span class="c27">:</span><span class="c15">&nbsp;You can correct the script by only changing 3-4 characters.</span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16"><span class="c17">Information</span><span>:- I used </span><span class="c8">Python </span><span class="c15">for this task. The code is written below </span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16"><span class="c17">Details</span><span class="c28">:-</span><span class="c21 c36">The bugs in the script can be fixed as follows:</span></p><ul class="c10 lst-kix_43p845uk44qo-0 start"><li class="c16 c25 li-bullet-0"><span>&nbsp;</span><span class="c11">In the second part of the script, when calculating the factorial, the range should start from 1, not from 0. This is because the factorial of 0 is 1.</span></li></ul><p class="c16 c18"><span class="c11"></span></p><ul class="c10 lst-kix_43p845uk44qo-0"><li class="c16 c25 li-bullet-0"><span class="c21">In the third part of the script, the sum of integers between 1 and (n-20) should be calculated using the formula for the sum of an arithmetic series, which is (n * (n + 1)) / 2, not by squaring and subtracting lim.</span></li></ul><p class="c16 c18"><span class="c15"></span></p><p class="c0"><span class="c4 c20"></span></p><p class="c3"><span class="c4">def</span><span class="c1">&nbsp;</span><span class="c14">compute</span><span class="c13">(</span><span class="c26">n</span><span class="c2">):</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">if</span><span class="c1">&nbsp;n </span><span class="c4">&lt;</span><span class="c1">&nbsp;</span><span class="c24">10</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; out </span><span class="c4">=</span><span class="c1">&nbsp;n </span><span class="c4">**</span><span class="c1">&nbsp;</span><span class="c24 c20">2</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">elif</span><span class="c1">&nbsp;n </span><span class="c4">&lt;</span><span class="c1">&nbsp;</span><span class="c24">20</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; out </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c24 c20">1</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c5">for</span><span class="c1">&nbsp;i </span><span class="c5">in</span><span class="c1">&nbsp;</span><span class="c14">range</span><span class="c13">(</span><span class="c24">1</span><span class="c13">,</span><span class="c1">&nbsp;n </span><span class="c4">-</span><span class="c1">&nbsp;</span><span class="c24">9</span><span class="c13">):</span><span class="c1">&nbsp; </span><span class="c6"># Fixed the range starting from 1</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out </span><span class="c4">*=</span><span class="c1 c20">&nbsp;i</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c5">else</span><span class="c2">:</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; lim </span><span class="c4">=</span><span class="c1">&nbsp;n </span><span class="c4">-</span><span class="c1">&nbsp;</span><span class="c20 c24">20</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; out </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c13">(</span><span class="c1">lim </span><span class="c4">*</span><span class="c1">&nbsp;</span><span class="c13">(</span><span class="c1">lim </span><span class="c4">+</span><span class="c1">&nbsp;</span><span class="c24">1</span><span class="c13">))</span><span class="c1">&nbsp;</span><span class="c4">//</span><span class="c1">&nbsp;</span><span class="c24">2</span><span class="c1">&nbsp; </span><span class="c6"># Fixed the calculation for sum of integers</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; </span><span class="c14">print</span><span class="c13">(</span><span class="c1">out</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c0"><span class="c1 c20"></span></p><p class="c3"><span class="c1">n </span><span class="c4">=</span><span class="c1">&nbsp;</span><span class="c29">int</span><span class="c13">(</span><span class="c14">input</span><span class="c13">(&quot;</span><span class="c7">Enter an integer: </span><span class="c2">&quot;))</span></p><p class="c3"><span class="c1">compute</span><span class="c13">(</span><span class="c1">n</span><span class="c2">)</span></p><p class="c0"><span class="c1 c20"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18"><span class="c15"></span></p><p class="c16 c18 c30"><span class="c11"></span></p><p class="c16 c18"><span class="c15"></span></p></body></html>